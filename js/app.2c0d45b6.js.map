{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?363d","webpack:///./src/App.vue","webpack:///./src/components/Mindmap/Mindmap.vue","webpack:///./src/tools/flextree/algorithm.ts","webpack:///./src/tools/flextree/helper.ts","webpack:///./src/tools/ImData.ts","webpack:///./src/components/Mindmap/Mindmap.vue?45e6","webpack:///./src/components/Mindmap/Mindmap.vue?8e34","webpack:///./src/components/Mindmap/index.ts","webpack:///./src/App.vue?3acc","webpack:///./src/App.vue?64a4","webpack:///./src/main.ts","webpack:///./src/components/Mindmap/Mindmap.module.scss?cb56"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","class","href","target","learn","branch","rangeList","x-gap","y-gap","zoom","checkboxList","fit-btn","center-btn","download-btn","drag","edit","item","type","disabled","for","min","max","ref","style","contenteditable","centerView","fitView","download","width","height","y","children","this","w","h","cs","x","prelim","mod","change","tl","tr","el","er","msel","mser","setExtremes","tree","bottom","lowY","index","next","updateIYL","minY","ih","IYL","distributeExtra","si","distance","nr","moveSubtree","nextLeftContour","nextRightContour","setLeftThread","cl","modsumcl","li","diff","setRightThread","sr","modsumsr","ri","seperate","mssr","mscl","sy","cy","positionRoot","firstWalk","addChildSpacing","modsumdelta","secondWalk","modsum","layout","gap","bottomPadding","addBoundingBox","removeBoundingBox","boundingBox","bb","treeData","convert","assignLayout","Tree","assignCoordinates","getSize","box","left","right","top","Math","child","colorScale","colorNumber","gKey","initTreeData","size","rawData","forEach","init","id","color","px","py","depth","floor","parent","dx","dy","swapWidthAndHeight","swapXAndY","renewDelta","renewId","renewColor","traverse","process","getLayout","xGap","yGap","BoundingBox","setBoundingBox","find","array","split","map","rename","reparent","parentId","delId","np","del","delIndex","pop","delParent","move","referenceId","after","idArr","refArr","refIndex","parseInt","rawChildren","props","modelValue","Array","required","Number","default","centerBtn","Boolean","fitBtn","downloadBtn","undoBtn","keyboard","showNodeAdd","contextMenu","setup","mmdata","svgEle","gEle","asstSvgEle","foreignEle","foreignDivEle","svg","g","asstSvg","foreign","link","linkHorizontal","source","on","onZoomMove","scaleExtent","onDragMove","onDragEnd","observer","ResizeObserver","arr","temp","pl","getComputedStyle","paddingLeft","b","parentNode","borderTopWidth","attr","contentRect","editFlag","rectPadding","select","observe","JSON","parse","stringify","draw","raise","addEventListener","onEditBlur","e","stopPropagation","oldSele","document","getElementsByClassName","selected","classList","remove","switchZoom","val","switchSelect","switchDrag","switchEdit","getGKey","getGClass","root","getGTransform","getColor","getPath","dpw","dph","getTspanData","multiline","getMultiline","getDataId","attrG","tran","temp1","join","temp2","transition","attrTspan","tspan","text","attrRootRect","rect","attrRect","attrPath","rp","radius","appendTspan","enter","append","updateTspan","update","appendNode","isRoot","enterG","onSelect","onEdit","gText","selectAll","each","filter","a","updateNode","gClass","makeTransition","easePolyOut","exit","sele","Error","tBox","node","getBBox","selectGNode","ele","querySelector","add","moveNode","dura","easingFn","duration","ease","transform","toString","mousePos","pointer","other","startsWith","x0","x1","y0","y1","old","from","outline","downD","upD","brothers","pid","getAttribute","edited","div","textContent","focus","getSelection","selectAllChildren","display","oldname","zoomable","editable","gNode","draggable","selectable","translateTo","gBB","svgBCR","getBoundingClientRect","multiple","svgCenter","gCenter","center","zoomIdentity","translate","scale","svgdiv","then","canvas","dataUrl","toDataURL","open","write","title","close","render","components","Mindmap","vertical","App","mount"],"mappings":"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","file":"js/app.2c0d45b6.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/vue3-mindmap/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../node_modules/vue-loader-v16/dist/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./App.vue?vue&type=style&index=0&lang=scss\"","<template>\n  <div class=\"container\">\n    <div class=\"left-top\">\n      <a href=\"https://github.com/hellowuxin/vue3-mindmap\" target=\"_blank\">GitHub</a>\n    </div>\n    <div class=\"right-top\"><span>Props</span></div>\n    <mindmap\n      class=\"left-bottom\"\n      v-model=\"learn\"\n      :branch=\"rangeList['branch'].value\"\n      :x-gap=\"rangeList['x-gap'].value\"\n      :y-gap=\"rangeList['y-gap'].value\"\n      :zoom=\"checkboxList['zoom'].value\"\n      :fit-btn=\"checkboxList['fit-btn'].value\"\n      :center-btn=\"checkboxList['center-btn'].value\"\n      :download-btn=\"checkboxList['download-btn'].value\"\n      :drag=\"checkboxList['drag'].value\"\n      :edit=\"checkboxList['edit'].value\"\n    ></mindmap>\n    <div class=\"right-bottom\">\n      <div v-for=\"(item, key) in checkboxList\" :key=\"key\">\n        <input type=\"checkbox\" :name=\"key\" v-model=\"item.value\" :disabled=\"item.disabled\">\n        <label :for=\"key\">{{ key }}</label>\n      </div>\n      <div v-for=\"(item, key) in rangeList\" :key=\"key\">\n        <input type=\"range\" :name=\"key\" v-model.number=\"item.value\" :min=\"item.min\" :max=\"item.max\">\n        <label :for=\"key\">{{ key }}</label>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport learn from '../public/learn.json'\nimport { defineComponent, reactive } from 'vue'\nimport Mindmap from './components/Mindmap'\ntype checkbox = { [key: string]: { value: boolean, disabled?: boolean } }\nexport default defineComponent({\n  name: 'App',\n  components: {\n    Mindmap\n  },\n  setup () {\n    const checkboxList = reactive<checkbox>({\n      'center-btn': { value: true },\n      'fit-btn': { value: true },\n      'undo-btn': { value: false, disabled: true },\n      'download-btn': { value: true },\n      keyboard: { value: false, disabled: true },\n      zoom: { value: true },\n      drag: { value: true },\n      edit: { value: true },\n      showNodeAdd: { value: false },\n      contextMenu: { value: false },\n      'sharp-corner': { value: false, disabled: true },\n      vertical: { value: false, disabled: true }\n    })\n    const rangeList = reactive({\n      branch: { value: 4, min: 0, max: 10 },\n      'x-gap': { value: 50, min: 0, max: 100 },\n      'y-gap': { value: 18, min: 0, max: 100 }\n    })\n    return {\n      learn,\n      checkboxList,\n      rangeList\n    }\n  }\n})\n</script>\n\n<style lang=\"scss\">\n.container {\n  width: 100%;\n  height: calc(100vh - 16px);\n  border-radius: 4px;\n  border: thin solid rgba(0,0,0,.12);\n  overflow: hidden;\n  background-color: rgba(0,0,0,.12);\n  display: grid;\n  grid-template-columns: 75% 1px 25%;\n  grid-template-rows: 48px 1px auto;\n}\n\n.right-top {\n  grid-column: 3 / 4;\n}\n\n.left-bottom {\n  grid-row: 3 / 4;\n}\n\n.right-bottom {\n  grid-column: 3 / 4;\n  grid-row: 3 / 4;\n  background-color: white;\n  padding: 12px;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  overflow: scroll;\n\n  div {\n    display: flex;\n    align-items: center;\n    gap: 5px;\n  }\n}\n\n.left-top,\n.right-top {\n  background-color: #eee;\n  padding: 0 12px;\n  display: flex;\n  align-items: center;\n}\n\ninput[type='checkbox'] {\n  cursor: pointer;\n}\n\ninput:disabled {\n  cursor: not-allowed;\n}\n</style>\n","<template>\n  <div :class=\"style['container']\">\n    <div :class=\"style['svg']\">\n      <svg :class=\"style['svg']\" ref=\"svgEle\">\n        <g ref=\"gEle\">\n          <foreignObject ref=\"foreignEle\" style=\"display: none\">\n            <div ref=\"foreignDivEle\" contenteditable></div>\n          </foreignObject>\n        </g>\n      </svg>\n    </div>\n    <svg ref=\"asstSvgEle\"></svg>\n    <div :class=\"[style['button-list'], style['right-bottom']]\">\n      <button v-if=\"centerBtn\" @click=\"centerView()\"><i :class=\"style['gps']\"></i></button>\n      <button v-if=\"fitBtn\" @click=\"fitView()\"><i :class=\"style['fit']\"></i></button>\n      <button v-if=\"downloadBtn\" @click=\"download()\"><i :class=\"style['download']\"></i></button>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, onMounted, PropType, Ref, ref, watch } from 'vue'\nimport { Data, Mdata } from '@/interface'\nimport style from './Mindmap.module.scss'\nimport { d3, ImData } from '@/tools'\nimport html2canvas from 'html2canvas'\n\ntype TspanData = { name: string, height: number }\ntype SelectionG = d3.Selection<SVGGElement, Mdata, SVGGElement, Mdata | null>\ntype Transition = d3.Transition<d3.BaseType, Mdata, SVGGElement, unknown>\n\nexport default defineComponent({\n  name: 'Mindmap',\n  props: {\n    modelValue: {\n      type: Array as PropType<Data[]>,\n      required: true\n    },\n    width: Number,\n    height: Number,\n    xGap: {\n      type: Number,\n      default: 50\n    },\n    yGap: {\n      type: Number,\n      default: 18\n    },\n    branch: {\n      type: Number,\n      default: 4\n    },\n    centerBtn: Boolean,\n    fitBtn: Boolean,\n    downloadBtn: Boolean,\n    undoBtn: Boolean,\n    edit: Boolean,\n    drag: Boolean,\n    keyboard: Boolean,\n    showNodeAdd: Boolean,\n    contextMenu: Boolean,\n    zoom: Boolean\n  },\n  setup (props) {\n    const svgEle: Ref<SVGSVGElement | undefined> = ref()\n    const gEle: Ref<SVGGElement | undefined> = ref()\n    const asstSvgEle: Ref<SVGSVGElement | undefined> = ref()\n    const foreignEle: Ref<SVGForeignObjectElement | undefined> = ref()\n    const foreignDivEle: Ref<HTMLDivElement | undefined> = ref()\n    const svg: Ref<d3.Selection<SVGSVGElement, null, null, undefined> | undefined> = ref()\n    const g: Ref<d3.Selection<SVGGElement, null, null, undefined> | undefined> = ref()\n    const asstSvg: Ref<d3.Selection<SVGSVGElement, unknown, null, undefined> | undefined> = ref()\n    const foreign: Ref<d3.Selection<SVGForeignObjectElement, null, null, undefined> | undefined> = ref()\n    const link = d3.linkHorizontal().source((d) => d.source).target((d) => d.target)\n    const zoom = d3.zoom<SVGSVGElement, null>().on('zoom', onZoomMove).scaleExtent([0.1, 8])\n    const drag = d3.drag<SVGGElement, Mdata>().on('drag', onDragMove).on('end', onDragEnd)\n    const observer = new ResizeObserver((arr) => {\n      if (!foreign.value) { return }\n      const temp = arr[0]\n      const target = temp.target\n      const pl = parseInt(getComputedStyle(target).paddingLeft || '0', 10)\n      const b = parseInt(getComputedStyle(target.parentNode as Element).borderTopWidth || '0', 10)\n      const gap = (pl + b) * 2\n      foreign.value.attr('width', temp.contentRect.width + gap).attr('height', temp.contentRect.height + gap)\n    })\n    let mmdata: ImData\n    let editFlag = false\n    const rectPadding = computed(() => props.yGap / 2 - 1)\n\n    onMounted(() => {\n      if (!svgEle.value || !gEle.value || !asstSvgEle.value || !foreignEle.value || !foreignDivEle.value) { return }\n      svg.value = d3.select(svgEle.value)\n      g.value = d3.select(gEle.value)\n      asstSvg.value = d3.select(asstSvgEle.value).attr('width', 0).attr('height', 0)\n      foreign.value = d3.select(foreignEle.value)\n      observer.observe(foreignDivEle.value)\n\n      mmdata = new ImData(\n        JSON.parse(JSON.stringify(props.modelValue[0])),\n        props.xGap,\n        props.yGap,\n        getSize\n      )\n\n      draw()\n      foreign.value.raise()\n      foreignDivEle.value.addEventListener('blur', onEditBlur)\n      foreignDivEle.value.addEventListener('mousedown', (e: MouseEvent) => e.stopPropagation())\n      centerView()\n      fitView()\n      // mousedown与drag/zoom绑定的先后顺序会有影响\n      svg.value.on('mousedown', () => {\n        const oldSele = document.getElementsByClassName(style.selected)[0]\n        oldSele?.classList.remove(style.selected)\n      })\n      switchZoom(props.zoom)\n    })\n    // watch\n    watch(() => props.branch, () => draw())\n    watch(() => [props.xGap, props.yGap], (val) => {\n      mmdata.setBoundingBox(val[0], val[1])\n      draw()\n    })\n    watch(() => [props.drag, props.edit], (val) => {\n      switchSelect(val[0] || val[1])\n      switchDrag(val[0])\n      switchEdit(val[1])\n    })\n    watch(() => props.zoom, (val) => switchZoom(val))\n    // 每个属性的计算方法\n    const getGKey = (d: Mdata) => { return d.gKey }\n    const getGClass = (d?: Mdata) => {\n      const arr = ['node']\n      if (d) {\n        arr.push(`depth-${d.depth}`)\n        if (d.depth === 0) { arr.push(style.root) }\n      }\n      return arr\n    }\n    const getGTransform = (d: Mdata) => { return `translate(${d.dx + d.px},${d.dy + d.py})` }\n    const getColor = (d: Mdata) => { return d.color }\n    const getPath = (d: Mdata) => {\n      let dpw = 0\n      let dph = 0\n      if (d.parent) {\n        dpw = d.parent.width\n        dph = d.parent.height\n        if (d.parent.depth === 0) {\n          dpw /= 2\n          dph /= 2\n        }\n      }\n      const temp = props.branch / 2\n      const source = [-d.dx + dpw - d.px, -d.dy + dph + temp - d.py] as [number, number]\n      const target = [0, d.height + temp] as [number, number]\n      return `${link({ source, target })}L${d.width},${target[1]}`\n    }\n    const getTspanData = (d: Mdata): TspanData[] => {\n      const multiline = getMultiline(d.name)\n      const height = d.height / multiline.length\n      return multiline.map((name) => ({ name, height }))\n    }\n    const getDataId = (d: Mdata) => { return d.id }\n    const getMultiline = (name: string) => {\n      const multiline = name.split('\\n')\n      if (multiline[multiline.length - 1] === '') { multiline.pop() }\n      return multiline\n    }\n    // 每个图形的绘制方法\n    const attrG = (g: SelectionG, tran?: Transition) => {\n      const temp1 = g.attr('class', (d) => getGClass(d).join(' ')).attr('data-id', getDataId)\n      const temp2 = tran ? temp1.transition(tran) : temp1\n      temp2.attr('transform', getGTransform)\n    }\n    const attrTspan = (tspan: d3.Selection<SVGTSpanElement, TspanData, SVGTextElement, Mdata>) => {\n      return tspan.attr('alignment-baseline', 'text-before-edge')\n        .text((d) => d.name || ' ')\n        .attr('x', 0)\n        .attr('dy', (d, i) => i ? d.height : 0)\n    }\n    const attrRootRect = (rect: d3.Selection<SVGRectElement, Mdata, SVGGElement, Mdata | null>) => {\n      return attrRect(rect, 10, 6)\n    }\n    const attrPath = (p: d3.Selection<SVGPathElement, Mdata, SVGGElement, Mdata | null>, tran?: Transition) => {\n      const temp1 = p.attr('stroke', getColor).attr('stroke-width', props.branch)\n      const temp2 = tran ? temp1.transition(tran) : temp1\n      return temp2.attr('d', getPath)\n    }\n    const attrRect = (rect: d3.Selection<SVGRectElement, Mdata, SVGGElement, Mdata | null>, rp = rectPadding.value, radius = 4) => {\n      rp = Math.min(rp, 10)\n      return rect.attr('x', -rp)\n        .attr('y', -rp)\n        .attr('rx', radius)\n        .attr('ry', radius)\n        .attr('width', (d) => d.width + rp * 2)\n        .attr('height', (d) => d.height + rp * 2)\n    }\n    // 绘制节点的方法\n    const appendTspan = (enter: d3.Selection<d3.EnterElement, TspanData, SVGTextElement, Mdata>) => {\n      return attrTspan(enter.append('tspan'))\n    }\n    const updateTspan = (update: d3.Selection<SVGTSpanElement, TspanData, SVGTextElement, Mdata>) => {\n      return attrTspan(update)\n    }\n    const appendNode = (enter: d3.Selection<d3.EnterElement, Mdata, SVGGElement, Mdata | null>) => {\n      const isRoot = !enter.data()[0]?.depth\n      const enterG = enter.append('g')\n      attrG(enterG)\n      if (props.drag || props.edit) {\n        enterG.on('mousedown', onSelect)\n        if (props.drag && !isRoot) { drag(enterG) }\n        if (props.edit) { enterG.on('click', onEdit) }\n      }\n      const gText = enterG.append('g').attr('class', style.text)\n      if (isRoot) {\n        attrRootRect(gText.append('rect'))\n      } else {\n        attrRect(gText.append('rect'))\n      }\n      const tspan = gText.append('text').selectAll('tspan').data(getTspanData).enter().append('tspan')\n      attrTspan(tspan)\n      attrPath(enterG.append('path'))\n\n      enterG.each((d, i) => {\n        if (!d.children) { return }\n        draw(d.children, enterG.filter((a, b) => i === b))\n      })\n      gText.raise()\n      return enterG\n    }\n    const updateNode = (update: SelectionG) => {\n      const isRoot = !update.data()[0]?.depth\n      const gClass = getGClass(update.data()[0] || {}).join('.')\n      const tran = makeTransition(500, d3.easePolyOut)\n      attrG(update, tran)\n      const gText = update.select<SVGGElement>(`g.${gClass} > g.${style.text}`)\n      if (isRoot) {\n        attrRootRect(gText.select('rect'))\n      } else {\n        attrRect(gText.select('rect'))\n      }\n      gText.select<SVGTextElement>('text')\n        .selectAll<SVGTSpanElement, TspanData>('tspan')\n        .data(getTspanData)\n        .join(appendTspan, updateTspan, exit => exit.remove())\n      attrPath(update.selectAll<SVGPathElement, Mdata>(`g.${gClass} > path`), tran)\n\n      update.each((d, i) => {\n        if (!d.children) { return }\n        draw(d.children, update.filter((a, b) => i === b))\n      })\n      gText.raise()\n      return update\n    }\n    // 其他\n    const draw = (d = [mmdata.data], sele = g.value as d3.Selection<SVGGElement, any, any, any>) => {\n      const temp = sele.selectAll<SVGGElement, Mdata>(`g.${getGClass(d[0]).join('.')}`)\n      temp.data(d, getGKey).join(appendNode, updateNode)\n    }\n    const getSize = (text: string): { width: number, height: number } => {\n      if (!asstSvg.value) { throw new Error('asstSvg undefined') }\n      const multiline = getMultiline(text)\n      const t = asstSvg.value.append('text')\n      t.selectAll('tspan').data(multiline).enter().append('tspan').text((d) => d).attr('x', 0)\n      const tBox = (t.node() as SVGTextElement).getBBox()\n      t.remove()\n      return {\n        width: Math.max(tBox.width, 22),\n        height: Math.max(tBox.height, 22) * multiline.length\n      }\n    }\n    const selectGNode = (d: Mdata) => {\n      const ele = document.querySelector(`g[data-id='${getDataId(d)}']`)\n      const oldSele = document.getElementsByClassName(style.selected)[0]\n      if (ele) {\n        if (oldSele) {\n          if (oldSele !== ele) {\n            oldSele.classList.remove(style.selected)\n            ele.classList.add(style.selected)\n          } else {\n            editFlag = true\n          }\n        } else {\n          ele.classList.add(style.selected)\n        }\n      } else {\n        throw new Error(`g[data-id='${getDataId(d)}'] is null`)\n      }\n    }\n    const moveNode = (node: SVGGElement, d: Mdata, p: [number, number], dura = 0) => {\n      const tran = makeTransition(dura, d3.easePolyOut)\n      d.px = p[0]\n      d.py = p[1]\n      d3.select<SVGGElement, Mdata>(node).transition(tran).attr('transform', getGTransform)\n      d3.select<SVGPathElement, Mdata>(`g[data-id='${getDataId(d)}'] > path`).transition(tran).attr('d', getPath)\n    }\n    const makeTransition = (dura: number, easingFn: (normalizedTime: number) => number) => {\n      return d3.transition<Mdata>().duration(dura).ease(easingFn) as d3.Transition<any, Mdata, null, undefined>\n    }\n    // 监听事件\n    function onZoomMove (e: d3.D3ZoomEvent<SVGSVGElement, null>) {\n      if (!g.value) { return }\n      g.value.attr('transform', e.transform.toString())\n    }\n    function onDragMove (this: SVGGElement, e: d3.D3DragEvent<SVGGElement, Mdata, Mdata>, d: Mdata) {\n      if (!g.value) { return }\n      moveNode(this, d, [e.x - d.x, e.y - d.y])\n      // 鼠标相对gEle左上角的位置\n      const mousePos = d3.pointer(e, gEle.value)\n      mousePos[1] += mmdata.data.y\n\n      const temp = g.value.selectAll<SVGGElement, Mdata>('g.node').filter((other) => {\n        if (other !== d && other !== d.parent && !other.id.startsWith(d.id)) {\n          const rect = {\n            x0: other.x - rectPadding.value,\n            x1: other.x + other.width + rectPadding.value,\n            y0: other.y - rectPadding.value,\n            y1: other.y + other.height + rectPadding.value\n          }\n          return mousePos[0] > rect.x0 && mousePos[1] > rect.y0 && mousePos[0] < rect.x1 && mousePos[1] < rect.y1\n        }\n        return false\n      })\n      const old = Array.from(document.getElementsByClassName(style.outline))\n      const n = temp.node()\n      old.forEach((o) => { if (o !== n) { o.classList.remove(style.outline) } })\n      n?.classList.add(style.outline)\n    }\n    function onDragEnd (this: SVGGElement, e: d3.D3DragEvent<SVGGElement, Mdata, Mdata>, d: Mdata) {\n      // 判断是否找到了新的父节点\n      const np = document.getElementsByClassName(style.outline)[0]\n      if (np) {\n        np.classList.remove(style.outline)\n        const pid = np.getAttribute('data-id')\n        if (pid) {\n          reparent(pid, d.id)\n        } else {\n          throw new Error('outline data-id null')\n        }\n        return\n      }\n      // 判断是否需要调换节点顺序\n      const p = this.parentNode as SVGGElement\n      let downD = d\n      let upD = d\n      const brothers = d3.select<SVGGElement, Mdata>(p).selectAll<SVGGElement, Mdata>(`g.${getGClass(d).join('.')}`).filter((a) => a !== d)\n      brothers.each((b) => {\n        if (b.y > d.y && b.y < (d.y + d.py) && b.y > upD.y) { upD = b } // 找新哥哥节点\n        if (b.y < d.y && b.y > (d.y + d.py) && b.y < downD.y) { downD = b } // 找新弟弟节点\n      })\n      if (downD !== d) {\n        d.px = 0\n        d.py = 0\n        move(d.id, downD.id)\n        return\n      } else if (upD !== d) {\n        d.px = 0\n        d.py = 0\n        move(d.id, upD.id, 1)\n        return\n      }\n      // 复原\n      moveNode(this, d, [0, 0], 500)\n    }\n    function onEdit (this: SVGGElement, e: MouseEvent, d: Mdata) {\n      if (editFlag && foreign.value && foreignDivEle.value) {\n        this.classList.add(style.edited)\n        editFlag = false\n        foreign.value.attr('x', d.x - 2).attr('y', d.y - mmdata.data.y - 2)\n          .attr('data-id', d.id).attr('data-name', d.name).style('display', '')\n        const div = foreignDivEle.value\n        div.textContent = d.name\n        div.focus()\n        getSelection()?.selectAllChildren(div)\n      }\n    }\n    const onEditBlur = () => {\n      document.getElementsByClassName(style.edited)[0]?.classList.remove(style.edited, style.selected)\n\n      if (foreignEle.value && foreignDivEle.value) {\n        foreignEle.value.style.display = 'none'\n        const id = foreignEle.value.getAttribute('data-id')\n        const oldname = foreignEle.value.getAttribute('data-name')\n        const name = foreignDivEle.value.textContent\n        if (id && name && name !== oldname) {\n          rename(id, name)\n        }\n      }\n    }\n    const onSelect = (e: MouseEvent, d: Mdata) => {\n      e.stopPropagation()\n      selectGNode(d)\n    }\n    // 插件\n    const switchZoom = (zoomable: boolean) => {\n      if (!svg.value) { return }\n      if (zoomable) {\n        zoom(svg.value)\n        svg.value.on('dblclick.zoom', null)\n      } else {\n        svg.value.on('.zoom', null)\n      }\n    }\n    const switchEdit = (editable: boolean) => {\n      if (!foreignDivEle.value || !g.value) { return }\n      const gNode = g.value.selectAll<SVGGElement, Mdata>('g.node')\n      if (editable) {\n        gNode.on('click', onEdit)\n      } else {\n        gNode.on('click', null)\n      }\n    }\n    const switchDrag = (draggable: boolean) => {\n      if (!g.value) { return }\n      const temp = g.value.selectAll<SVGGElement, Mdata>(`g.node:not(.${style.root})`)\n      if (draggable) {\n        drag(temp)\n      } else {\n        temp.on('.drag', null)\n      }\n    }\n    const switchSelect = (selectable: boolean) => {\n      if (!g.value) { return }\n      const temp = g.value.selectAll<SVGGElement, Mdata>('g.node')\n      if (selectable) {\n        temp.on('mousedown', onSelect)\n      } else {\n        temp.on('mousedown', null)\n      }\n    }\n    // 一次操作\n    const rename = (id: string, name: string) => {\n      mmdata.rename(id, name)\n      draw()\n    }\n    const reparent = (pid: string, id: string) => {\n      mmdata.reparent(pid, id)\n      draw()\n    }\n    const move = (id: string, referenceId: string, after = 0) => {\n      mmdata.move(id, referenceId, after)\n      draw()\n    }\n    // 辅助按钮的点击事件\n    const centerView = () => {\n      if (!svg.value) { return }\n      const data = mmdata.data\n      zoom.translateTo(svg.value, 0 + data.width / 2, 0 + data.height / 2)\n    }\n    const fitView = () => { // 缩放至合适大小并移动至全部可见\n      // bug: 缩放后的大小与容器不一致\n      if (!svg.value || !gEle.value || !svgEle.value) { return }\n      const gBB = gEle.value.getBBox()\n      const svgBCR = svgEle.value.getBoundingClientRect()\n      const multiple = Math.min(svgBCR.width / gBB.width, svgBCR.height / gBB.height)\n      const svgCenter = { x: svgBCR.width / 2, y: svgBCR.height / 2 }\n      // after scale\n      const gCenter = { x: gBB.width * multiple / 2, y: gBB.height * multiple / 2 }\n      const center = d3.zoomIdentity.translate(\n        -gBB.x * multiple + svgCenter.x - gCenter.x,\n        -gBB.y * multiple + svgCenter.y - gCenter.y\n      ).scale(multiple)\n      zoom.transform(svg.value, center)\n    }\n    const download = () => {\n      const svgdiv = document.querySelector<HTMLDivElement>(`div.${style.svg}`)\n      if (svgdiv) {\n        html2canvas(svgdiv).then((canvas) => {\n          const dataUrl = canvas.toDataURL()\n          const window = open()\n          if (window) {\n            window.document.write(`<img src='${dataUrl}'>`)\n            window.document.title = mmdata.data.name\n            window.document.close()\n          }\n        })\n      }\n    }\n\n    return {\n      svgEle,\n      gEle,\n      style,\n      asstSvgEle,\n      foreignEle,\n      foreignDivEle,\n      centerView,\n      fitView,\n      download\n    }\n  }\n})\n</script>\n","class Tree {\n  w: number\n  h: number\n  y: number\n  c: Tree[]\n  cs: number\n  x: number\n  prelim: number\n  mod: number\n  shift: number\n  change: number\n  tl: Tree | null\n  tr: Tree | null\n  el: Tree | null\n  er: Tree | null\n  msel: number\n  mser: number\n\n  constructor (width: number, height: number, y: number, children: Tree[]) {\n    this.w = width\n    this.h = height\n    this.y = y\n    this.c = children\n    this.cs = children.length\n\n    this.x = 0\n    this.prelim = 0\n    this.mod = 0\n    this.shift = 0\n    this.change = 0\n    this.tl = null // Left thread\n    this.tr = null // Right thread\n    this.el = null // extreme left nodes\n    this.er = null // extreme right nodes\n    // sum of modifiers at the extreme nodes\n    this.msel = 0\n    this.mser = 0\n  }\n}\n\nfunction setExtremes (tree: Tree) {\n  if (tree.cs === 0) {\n    tree.el = tree\n    tree.er = tree\n    tree.msel = tree.mser = 0\n  } else {\n    tree.el = tree.c[0].el\n    tree.msel = tree.c[0].msel\n    tree.er = tree.c[tree.cs - 1].er\n    tree.mser = tree.c[tree.cs - 1].mser\n  }\n}\n\nfunction bottom (tree: Tree) {\n  return tree.y + tree.h\n}\n\n/* A linked list of the indexes of left siblings and their lowest vertical coordinate.\n */\nclass IYL {\n  lowY: number\n  index: number\n  next: IYL | null\n  constructor (lowY: number, index: number, next: IYL | null) {\n    this.lowY = lowY\n    this.index = index\n    this.next = next\n  }\n}\n\nfunction updateIYL (minY: number, i: number, ih: IYL | null) {\n  // Remove siblings that are hidden by the new subtree.\n  while (ih !== null && minY >= ih.lowY) {\n    // Prepend the new subtree\n    ih = ih.next\n  }\n  return new IYL(minY, i, ih)\n}\n\nfunction distributeExtra (tree: Tree, i: number, si: number, distance: number) {\n  // Are there intermediate children?\n  if (si !== i - 1) {\n    const nr = i - si\n    tree.c[si + 1].shift += distance / nr\n    tree.c[i].shift -= distance / nr\n    tree.c[i].change -= distance - distance / nr\n  }\n}\n\nfunction moveSubtree (tree: Tree, i: number, si: number, distance: number) {\n  // Move subtree by changing mod.\n  tree.c[i].mod += distance\n  tree.c[i].msel += distance\n  tree.c[i].mser += distance\n  distributeExtra(tree, i, si, distance)\n}\n\nfunction nextLeftContour (tree: Tree) {\n  return tree.cs === 0 ? tree.tl : tree.c[0]\n}\n\nfunction nextRightContour (tree: Tree) {\n  return tree.cs === 0 ? tree.tr : tree.c[tree.cs - 1]\n}\n\nfunction setLeftThread (tree: Tree, i: number, cl: Tree, modsumcl: number) {\n  const li = tree.c[0].el as Tree\n  li.tl = cl\n  // Change mod so that the sum of modifier after following thread is correct.\n  const diff = (modsumcl - cl.mod) - tree.c[0].msel\n  li.mod += diff\n  // Change preliminary x coordinate so that the node does not move.\n  li.prelim -= diff\n  // Update extreme node and its sum of modifiers.\n  tree.c[0].el = tree.c[i].el\n  tree.c[0].msel = tree.c[i].msel\n}\n\n// Symmetrical to setLeftThread\nfunction setRightThread (tree: Tree, i: number, sr: Tree, modsumsr: number) {\n  const ri = tree.c[i].er as Tree\n  ri.tr = sr\n  const diff = (modsumsr - sr.mod) - tree.c[i].mser\n  ri.mod += diff\n  ri.prelim -= diff\n  tree.c[i].er = tree.c[i - 1].er\n  tree.c[i].mser = tree.c[i - 1].mser\n}\n\nfunction seperate (tree: Tree, i: number, ih: IYL) {\n  // Right contour node of left siblings and its sum of modifiers.\n  let sr: Tree | null = tree.c[i - 1]\n  let mssr = sr.mod\n  // Left contour node of right siblings and its sum of modifiers.\n  let cl: Tree | null = tree.c[i]\n  let mscl = cl.mod\n  while (sr !== null && cl !== null) {\n    if (bottom(sr) > ih.lowY) {\n      ih = ih.next as IYL\n    }\n    // How far to the left of the right side of sr is the left side of cl.\n    const distance = mssr + sr.prelim + sr.w - (mscl + cl.prelim)\n    if (distance > 0) {\n      mscl += distance\n      moveSubtree(tree, i, ih.index, distance)\n    }\n\n    const sy = bottom(sr)\n    const cy = bottom(cl)\n    if (sy <= cy) {\n      sr = nextRightContour(sr)\n      if (sr !== null) {\n        mssr += sr.mod\n      }\n    }\n    if (sy >= cy) {\n      cl = nextLeftContour(cl)\n      if (cl !== null) {\n        mscl += cl.mod\n      }\n    }\n  }\n\n  // Set threads and update extreme nodes.\n  // In the first case, the current subtree must be taller than the left siblings.\n  if (sr === null && cl !== null) {\n    setLeftThread(tree, i, cl, mscl)\n  } else if (sr !== null && cl === null) {\n    setRightThread(tree, i, sr, mssr)\n  }\n}\n\nfunction positionRoot (tree: Tree) {\n  // Position root between children, taking into account their mod.\n  tree.prelim =\n    (tree.c[0].prelim +\n      tree.c[0].mod +\n      tree.c[tree.cs - 1].mod +\n      tree.c[tree.cs - 1].prelim +\n      tree.c[tree.cs - 1].w) /\n      2 -\n    tree.w / 2\n}\n\nfunction firstWalk (tree: Tree) {\n  if (tree.cs === 0) {\n    setExtremes(tree)\n    return\n  }\n\n  firstWalk(tree.c[0])\n  let ih = updateIYL(bottom(tree.c[0].el as Tree), 0, null)\n  for (let i = 1; i < tree.cs; i++) {\n    firstWalk(tree.c[i])\n    const minY = bottom(tree.c[i].er as Tree)\n    seperate(tree, i, ih)\n    ih = updateIYL(minY, i, ih)\n  }\n  positionRoot(tree)\n  setExtremes(tree)\n}\n\nfunction addChildSpacing (tree: Tree) {\n  let d = 0\n  let modsumdelta = 0\n  for (let i = 0; i < tree.cs; i++) {\n    d += tree.c[i].shift\n    modsumdelta += d + tree.c[i].change\n    tree.c[i].mod += modsumdelta\n  }\n}\n\nfunction secondWalk (tree: Tree, modsum: number) {\n  modsum += tree.mod\n  // Set absolute (no-relative) horizontal coordinates.\n  tree.x = tree.prelim + modsum\n  addChildSpacing(tree)\n  for (let i = 0; i < tree.cs; i++) {\n    secondWalk(tree.c[i], modsum)\n  }\n}\n\nfunction layout (tree: Tree): void {\n  firstWalk(tree)\n  secondWalk(tree, 0)\n}\n\nexport { Tree, layout }\n","import { layout, Tree } from './algorithm'\n\nexport type TreeData = {\n  width: number\n  height: number\n  children?: TreeData[]\n  x: number\n  y: number\n}\ninterface Box {\n  left: number\n  right: number\n  top: number\n  bottom: number\n}\n\nexport class BoundingBox {\n  gap: number\n  bottomPadding: number\n  /**\n   * @param {number} gap - the gap between sibling nodes\n   * @param {number} bottomPadding - the height reserved for connection drawing\n   */\n  constructor (gap: number, bottomPadding: number) {\n    this.gap = gap\n    this.bottomPadding = bottomPadding\n  }\n\n  addBoundingBox (width: number, height: number): { width: number, height: number } {\n    return { width: width + this.gap, height: height + this.bottomPadding }\n  }\n\n  /**\n   * Return the coordinate without the bounding box for a node\n   */\n  removeBoundingBox (x: number, y: number): { x: number, y: number } {\n    return { x: x + this.gap / 2, y }\n  }\n}\n\nexport class Layout {\n  bb: BoundingBox\n  constructor (boundingBox: BoundingBox) {\n    this.bb = boundingBox\n  }\n\n  /**\n   * Layout treeData.\n   * Return modified treeData and the bounding box encompassing all the nodes.\n   *\n   * See getSize() for more explanation.\n   */\n  layout<T extends TreeData> (treeData: T): { result: T, boundingBox: Box } {\n    const tree = this.convert(treeData)\n    layout(tree)\n    const { boundingBox, result } = this.assignLayout(tree, treeData)\n\n    return { result, boundingBox }\n  }\n\n  /**\n   * Returns Tree to layout, with bounding boxes added to each node.\n   */\n  convert (treeData: TreeData, y = 0): Tree {\n    const { width, height } = this.bb.addBoundingBox(\n      treeData.width,\n      treeData.height\n    )\n    const children = []\n    if (treeData.children && treeData.children.length) {\n      for (let i = 0; i < treeData.children.length; i++) {\n        children[i] = this.convert(treeData.children[i], y + height)\n      }\n    }\n\n    return new Tree(width, height, y, children)\n  }\n\n  /**\n   * Assign layout tree x, y coordinates back to treeData,\n   * with bounding boxes removed.\n   */\n  assignCoordinates (tree: Tree, treeData: TreeData): void {\n    const { x, y } = this.bb.removeBoundingBox(tree.x, tree.y)\n    treeData.x = x\n    treeData.y = y\n    for (let i = 0; i < tree.c.length; i++) {\n      this.assignCoordinates(tree.c[i], (treeData.children as TreeData[])[i])\n    }\n  }\n\n  /**\n   * Return the bounding box that encompasses all the nodes.\n   * The result has a structure of\n   * { left: number, right: number, top: number, bottom: nubmer}.\n   * This is not the same bounding box concept as the `BoundingBox` class\n   * used to construct `Layout` class.\n   */\n  getSize (treeData: TreeData, box?: Box): Box {\n    const { x, y, width, height } = treeData\n    if (!box) {\n      box = { left: x, right: x + width, top: y, bottom: y + height }\n    }\n    box.left = Math.min(box.left, x)\n    box.right = Math.max(box.right, x + width)\n    box.top = Math.min(box.top, y)\n    box.bottom = Math.max(box.bottom, y + height)\n\n    if (treeData.children) {\n      for (const child of treeData.children) {\n        this.getSize(child, box)\n      }\n    }\n\n    return box\n  }\n\n  /**\n   * This function does assignCoordinates and getSize in one pass.\n   */\n  assignLayout<T extends TreeData> (tree: Tree, treeData: T, box?: Box): { result: T, boundingBox: Box } {\n    const { x, y } = this.bb.removeBoundingBox(tree.x, tree.y)\n    treeData.x = x\n    treeData.y = y\n\n    const { width, height } = treeData\n    if (!box) {\n      box = { left: x, right: x + width, top: y, bottom: y + height }\n    }\n    box.left = Math.min(box.left, x)\n    box.right = Math.max(box.right, x + width)\n    box.top = Math.min(box.top, y)\n    box.bottom = Math.max(box.bottom, y + height)\n\n    for (let i = 0; i < tree.c.length; i++) {\n      this.assignLayout(tree.c[i], (treeData.children as T[])[i], box)\n    }\n\n    return { result: treeData, boundingBox: box }\n  }\n}\n","import * as d3ScaleChromatic from 'd3-scale-chromatic'\nimport * as d3Scale from 'd3-scale'\nimport { Data, Mdata } from '@/interface'\nimport { BoundingBox, Layout } from '@/tools/flextree'\n\ntype GetSize = (text: string) => { width: number, height: number }\ntype Processer = (d: Mdata, id: string) => void\ntype IsMdata = Mdata | null\n\ninterface TreeData {\n  rawData: Data\n  width: number\n  height: number\n  x: number\n  y: number\n  children?: TreeData[]\n}\n\nconst colorScale = d3Scale.scaleOrdinal(d3ScaleChromatic.schemePaired) // 颜色列表\nlet colorNumber = 0\nlet gKey = 0\n\n// rawData width height x y children\nfunction initTreeData (d: Data, getSize: GetSize) {\n  const size = getSize(d.name)\n  const data: TreeData = {\n    rawData: d,\n    width: size.height,\n    height: size.width,\n    x: 0,\n    y: 0\n  }\n\n  const { children } = d\n  if (children) {\n    const dataChildren: TreeData[] = data.children = []\n    children.forEach((child) => {\n      dataChildren.push(initTreeData(child, getSize))\n    })\n  }\n\n  return data\n}\n// id gKey depth dx dy name left color px py\nconst init = (d: TreeData, id = '0', p: IsMdata = null, c?: string) => {\n  const x = d.y\n  const y = d.x\n  let color = ''\n  let left = false\n  let px = x\n  let py = y\n  if (p) {\n    left = p.left\n    px = p.x\n    py = p.y\n    color = c || colorScale(`${colorNumber += 1}`)\n  }\n  const data: Mdata = {\n    x,\n    y,\n    width: d.height,\n    height: d.width,\n    id,\n    gKey: (gKey += 1),\n    depth: Math.floor(id.length / 2),\n    name: d.rawData.name,\n    px: 0,\n    py: 0,\n    rawData: d.rawData,\n    parent: p,\n    color,\n    left,\n    dx: x - px,\n    dy: y - py\n  }\n  if (d.children) {\n    data.children = []\n    d.children.forEach((c, j) => {\n      data.children?.push(init(c, `${id}-${j}`, data, color))\n    })\n  }\n  return data\n}\n\nfunction swapWidthAndHeight<T extends { width: number, height: number }> (d: T) {\n  [d.width, d.height] = [d.height, d.width]\n}\n\nconst swapXAndY = <T extends { x: number, y: number }>(d: T) => {\n  [d.x, d.y] = [d.y, d.x]\n}\n\nconst renewDelta = <T extends { x: number, y: number, parent: T | null, dx: number, dy: number }>(d: T) => {\n  if (d.parent) {\n    d.dx = d.x - d.parent.x\n    d.dy = d.y - d.parent.y\n  } else {\n    d.dx = 0\n    d.dy = 0\n  }\n}\n\nconst renewId = <T extends { id: string }>(d: T, id: string) => {\n  d.id = id\n}\n\nconst renewColor = <T extends { color: string, parent: T | null }>(d: T) => {\n  if (d.parent) {\n    if (d.parent.color) {\n      d.color = d.parent.color\n    } else if (!d.color) {\n      d.color = colorScale(`${colorNumber += 1}`)\n    }\n  }\n}\n\nconst traverse = (d: Mdata, process: Processer[], id = '0') => {\n  process.forEach((p) => { p(d, id) })\n  d.children?.forEach((child, index) => { traverse(child, process, `${id}-${index}`) })\n}\n\nconst getLayout = (xGap: number, yGap: number) => {\n  const bb = new BoundingBox(yGap, xGap)\n  return new Layout(bb)\n}\n\nclass ImData {\n  data: Mdata\n  private getSize: GetSize\n  private layout: Layout\n\n  constructor (d: Data, xGap: number, yGap: number, getSize: GetSize) {\n    const data = initTreeData(d, getSize)\n    this.layout = getLayout(xGap, yGap)\n    this.layout.layout(data)\n    this.data = init(data)\n    this.getSize = getSize\n  }\n\n  setBoundingBox (xGap: number, yGap: number): void {\n    this.layout = getLayout(xGap, yGap)\n    traverse(this.data, [swapWidthAndHeight])\n    this.layout.layout(this.data)\n    traverse(this.data, [swapWidthAndHeight, swapXAndY, renewDelta])\n  }\n\n  find (id: string): IsMdata { // 根据id找到数据\n    const array = id.split('-').map(n => ~~n)\n    let data = this.data\n    for (let i = 1; i < array.length; i++) {\n      if (data && data.children) {\n        data = data.children[array[i]]\n      } else { // No data matching id\n        return null\n      }\n    }\n    return data\n  }\n\n  rename (id: string, name: string): IsMdata { // 修改名称\n    if (id.length > 0) {\n      const d = this.find(id)\n      if (d && d.name !== name) {\n        d.name = name\n        d.rawData.name = name\n        //\n        const size = this.getSize(d.name)\n        d.width = size.width\n        d.height = size.height\n        traverse(this.data, [swapWidthAndHeight])\n        this.layout.layout(this.data)\n        traverse(this.data, [swapWidthAndHeight, swapXAndY, renewDelta])\n      }\n      return d\n    } else {\n      return null\n    }\n  }\n\n  reparent (parentId: string, delId: string): IsMdata { // 节点移动到其他层\n    if (parentId === delId) { return null }\n    const np = this.find(parentId)\n    const del = this.find(delId)\n    const delIndex = delId.split('-').pop()\n    if (delIndex && np && del) {\n      const delParent = del.parent\n      delParent?.children?.splice(~~delIndex, 1)\n      delParent?.rawData.children?.splice(~~delIndex, 1)\n      del.parent = np\n      del.gKey = gKey += 1\n      del.depth = del.parent.depth + 1\n      if (del.depth === 1) { del.color = colorScale(`${colorNumber += 1}`) }\n      np.children ? np.children.push(del) : np.children = [del]\n      np.rawData.children ? np.rawData.children.push(del.rawData) : np.rawData.children = [del.rawData]\n      traverse(this.data, [swapWidthAndHeight])\n      this.layout.layout(this.data)\n      traverse(this.data, [swapWidthAndHeight, swapXAndY, renewDelta, renewId, renewColor])\n    }\n    return del\n  }\n\n  move (id: string, referenceId: string, after = 0): IsMdata { // 同层调换顺序\n    const idArr = id.split('-')\n    const refArr = referenceId.split('-')\n    let index: number | string | undefined = idArr.pop()\n    let refIndex: number | string | undefined = refArr.pop()\n    if (id === referenceId || idArr.length !== refArr.length || !index || !refIndex) { return null }\n    const d = this.find(id)\n    if (d && d.parent) {\n      index = parseInt(index, 10)\n      refIndex = parseInt(refIndex, 10)\n      if (index < refIndex) { refIndex -= 1 } // 删除时可能会改变插入的序号\n      const { children } = d.parent\n      const { children: rawChildren } = d.parent.rawData\n      if (children && rawChildren) {\n        children.splice(index, 1)\n        children.splice(refIndex + after, 0, d)\n        rawChildren.splice(index, 1)\n        rawChildren.splice(refIndex + after, 0, d.rawData)\n        traverse(this.data, [swapWidthAndHeight])\n        this.layout.layout(this.data)\n        traverse(this.data, [swapWidthAndHeight, swapXAndY, renewDelta, renewId])\n        return d\n      }\n    }\n    return null\n  }\n}\n\nexport default ImData\n","\nimport { computed, defineComponent, onMounted, PropType, Ref, ref, watch } from 'vue'\nimport { Data, Mdata } from '@/interface'\nimport style from './Mindmap.module.scss'\nimport { d3, ImData } from '@/tools'\nimport html2canvas from 'html2canvas'\n\ntype TspanData = { name: string, height: number }\ntype SelectionG = d3.Selection<SVGGElement, Mdata, SVGGElement, Mdata | null>\ntype Transition = d3.Transition<d3.BaseType, Mdata, SVGGElement, unknown>\n\nexport default defineComponent({\n  name: 'Mindmap',\n  props: {\n    modelValue: {\n      type: Array as PropType<Data[]>,\n      required: true\n    },\n    width: Number,\n    height: Number,\n    xGap: {\n      type: Number,\n      default: 50\n    },\n    yGap: {\n      type: Number,\n      default: 18\n    },\n    branch: {\n      type: Number,\n      default: 4\n    },\n    centerBtn: Boolean,\n    fitBtn: Boolean,\n    downloadBtn: Boolean,\n    undoBtn: Boolean,\n    edit: Boolean,\n    drag: Boolean,\n    keyboard: Boolean,\n    showNodeAdd: Boolean,\n    contextMenu: Boolean,\n    zoom: Boolean\n  },\n  setup (props) {\n    const svgEle: Ref<SVGSVGElement | undefined> = ref()\n    const gEle: Ref<SVGGElement | undefined> = ref()\n    const asstSvgEle: Ref<SVGSVGElement | undefined> = ref()\n    const foreignEle: Ref<SVGForeignObjectElement | undefined> = ref()\n    const foreignDivEle: Ref<HTMLDivElement | undefined> = ref()\n    const svg: Ref<d3.Selection<SVGSVGElement, null, null, undefined> | undefined> = ref()\n    const g: Ref<d3.Selection<SVGGElement, null, null, undefined> | undefined> = ref()\n    const asstSvg: Ref<d3.Selection<SVGSVGElement, unknown, null, undefined> | undefined> = ref()\n    const foreign: Ref<d3.Selection<SVGForeignObjectElement, null, null, undefined> | undefined> = ref()\n    const link = d3.linkHorizontal().source((d) => d.source).target((d) => d.target)\n    const zoom = d3.zoom<SVGSVGElement, null>().on('zoom', onZoomMove).scaleExtent([0.1, 8])\n    const drag = d3.drag<SVGGElement, Mdata>().on('drag', onDragMove).on('end', onDragEnd)\n    const observer = new ResizeObserver((arr) => {\n      if (!foreign.value) { return }\n      const temp = arr[0]\n      const target = temp.target\n      const pl = parseInt(getComputedStyle(target).paddingLeft || '0', 10)\n      const b = parseInt(getComputedStyle(target.parentNode as Element).borderTopWidth || '0', 10)\n      const gap = (pl + b) * 2\n      foreign.value.attr('width', temp.contentRect.width + gap).attr('height', temp.contentRect.height + gap)\n    })\n    let mmdata: ImData\n    let editFlag = false\n    const rectPadding = computed(() => props.yGap / 2 - 1)\n\n    onMounted(() => {\n      if (!svgEle.value || !gEle.value || !asstSvgEle.value || !foreignEle.value || !foreignDivEle.value) { return }\n      svg.value = d3.select(svgEle.value)\n      g.value = d3.select(gEle.value)\n      asstSvg.value = d3.select(asstSvgEle.value).attr('width', 0).attr('height', 0)\n      foreign.value = d3.select(foreignEle.value)\n      observer.observe(foreignDivEle.value)\n\n      mmdata = new ImData(\n        JSON.parse(JSON.stringify(props.modelValue[0])),\n        props.xGap,\n        props.yGap,\n        getSize\n      )\n\n      draw()\n      foreign.value.raise()\n      foreignDivEle.value.addEventListener('blur', onEditBlur)\n      foreignDivEle.value.addEventListener('mousedown', (e: MouseEvent) => e.stopPropagation())\n      centerView()\n      fitView()\n      // mousedown与drag/zoom绑定的先后顺序会有影响\n      svg.value.on('mousedown', () => {\n        const oldSele = document.getElementsByClassName(style.selected)[0]\n        oldSele?.classList.remove(style.selected)\n      })\n      switchZoom(props.zoom)\n    })\n    // watch\n    watch(() => props.branch, () => draw())\n    watch(() => [props.xGap, props.yGap], (val) => {\n      mmdata.setBoundingBox(val[0], val[1])\n      draw()\n    })\n    watch(() => [props.drag, props.edit], (val) => {\n      switchSelect(val[0] || val[1])\n      switchDrag(val[0])\n      switchEdit(val[1])\n    })\n    watch(() => props.zoom, (val) => switchZoom(val))\n    // 每个属性的计算方法\n    const getGKey = (d: Mdata) => { return d.gKey }\n    const getGClass = (d?: Mdata) => {\n      const arr = ['node']\n      if (d) {\n        arr.push(`depth-${d.depth}`)\n        if (d.depth === 0) { arr.push(style.root) }\n      }\n      return arr\n    }\n    const getGTransform = (d: Mdata) => { return `translate(${d.dx + d.px},${d.dy + d.py})` }\n    const getColor = (d: Mdata) => { return d.color }\n    const getPath = (d: Mdata) => {\n      let dpw = 0\n      let dph = 0\n      if (d.parent) {\n        dpw = d.parent.width\n        dph = d.parent.height\n        if (d.parent.depth === 0) {\n          dpw /= 2\n          dph /= 2\n        }\n      }\n      const temp = props.branch / 2\n      const source = [-d.dx + dpw - d.px, -d.dy + dph + temp - d.py] as [number, number]\n      const target = [0, d.height + temp] as [number, number]\n      return `${link({ source, target })}L${d.width},${target[1]}`\n    }\n    const getTspanData = (d: Mdata): TspanData[] => {\n      const multiline = getMultiline(d.name)\n      const height = d.height / multiline.length\n      return multiline.map((name) => ({ name, height }))\n    }\n    const getDataId = (d: Mdata) => { return d.id }\n    const getMultiline = (name: string) => {\n      const multiline = name.split('\\n')\n      if (multiline[multiline.length - 1] === '') { multiline.pop() }\n      return multiline\n    }\n    // 每个图形的绘制方法\n    const attrG = (g: SelectionG, tran?: Transition) => {\n      const temp1 = g.attr('class', (d) => getGClass(d).join(' ')).attr('data-id', getDataId)\n      const temp2 = tran ? temp1.transition(tran) : temp1\n      temp2.attr('transform', getGTransform)\n    }\n    const attrTspan = (tspan: d3.Selection<SVGTSpanElement, TspanData, SVGTextElement, Mdata>) => {\n      return tspan.attr('alignment-baseline', 'text-before-edge')\n        .text((d) => d.name || ' ')\n        .attr('x', 0)\n        .attr('dy', (d, i) => i ? d.height : 0)\n    }\n    const attrRootRect = (rect: d3.Selection<SVGRectElement, Mdata, SVGGElement, Mdata | null>) => {\n      return attrRect(rect, 10, 6)\n    }\n    const attrPath = (p: d3.Selection<SVGPathElement, Mdata, SVGGElement, Mdata | null>, tran?: Transition) => {\n      const temp1 = p.attr('stroke', getColor).attr('stroke-width', props.branch)\n      const temp2 = tran ? temp1.transition(tran) : temp1\n      return temp2.attr('d', getPath)\n    }\n    const attrRect = (rect: d3.Selection<SVGRectElement, Mdata, SVGGElement, Mdata | null>, rp = rectPadding.value, radius = 4) => {\n      rp = Math.min(rp, 10)\n      return rect.attr('x', -rp)\n        .attr('y', -rp)\n        .attr('rx', radius)\n        .attr('ry', radius)\n        .attr('width', (d) => d.width + rp * 2)\n        .attr('height', (d) => d.height + rp * 2)\n    }\n    // 绘制节点的方法\n    const appendTspan = (enter: d3.Selection<d3.EnterElement, TspanData, SVGTextElement, Mdata>) => {\n      return attrTspan(enter.append('tspan'))\n    }\n    const updateTspan = (update: d3.Selection<SVGTSpanElement, TspanData, SVGTextElement, Mdata>) => {\n      return attrTspan(update)\n    }\n    const appendNode = (enter: d3.Selection<d3.EnterElement, Mdata, SVGGElement, Mdata | null>) => {\n      const isRoot = !enter.data()[0]?.depth\n      const enterG = enter.append('g')\n      attrG(enterG)\n      if (props.drag || props.edit) {\n        enterG.on('mousedown', onSelect)\n        if (props.drag && !isRoot) { drag(enterG) }\n        if (props.edit) { enterG.on('click', onEdit) }\n      }\n      const gText = enterG.append('g').attr('class', style.text)\n      if (isRoot) {\n        attrRootRect(gText.append('rect'))\n      } else {\n        attrRect(gText.append('rect'))\n      }\n      const tspan = gText.append('text').selectAll('tspan').data(getTspanData).enter().append('tspan')\n      attrTspan(tspan)\n      attrPath(enterG.append('path'))\n\n      enterG.each((d, i) => {\n        if (!d.children) { return }\n        draw(d.children, enterG.filter((a, b) => i === b))\n      })\n      gText.raise()\n      return enterG\n    }\n    const updateNode = (update: SelectionG) => {\n      const isRoot = !update.data()[0]?.depth\n      const gClass = getGClass(update.data()[0] || {}).join('.')\n      const tran = makeTransition(500, d3.easePolyOut)\n      attrG(update, tran)\n      const gText = update.select<SVGGElement>(`g.${gClass} > g.${style.text}`)\n      if (isRoot) {\n        attrRootRect(gText.select('rect'))\n      } else {\n        attrRect(gText.select('rect'))\n      }\n      gText.select<SVGTextElement>('text')\n        .selectAll<SVGTSpanElement, TspanData>('tspan')\n        .data(getTspanData)\n        .join(appendTspan, updateTspan, exit => exit.remove())\n      attrPath(update.selectAll<SVGPathElement, Mdata>(`g.${gClass} > path`), tran)\n\n      update.each((d, i) => {\n        if (!d.children) { return }\n        draw(d.children, update.filter((a, b) => i === b))\n      })\n      gText.raise()\n      return update\n    }\n    // 其他\n    const draw = (d = [mmdata.data], sele = g.value as d3.Selection<SVGGElement, any, any, any>) => {\n      const temp = sele.selectAll<SVGGElement, Mdata>(`g.${getGClass(d[0]).join('.')}`)\n      temp.data(d, getGKey).join(appendNode, updateNode)\n    }\n    const getSize = (text: string): { width: number, height: number } => {\n      if (!asstSvg.value) { throw new Error('asstSvg undefined') }\n      const multiline = getMultiline(text)\n      const t = asstSvg.value.append('text')\n      t.selectAll('tspan').data(multiline).enter().append('tspan').text((d) => d).attr('x', 0)\n      const tBox = (t.node() as SVGTextElement).getBBox()\n      t.remove()\n      return {\n        width: Math.max(tBox.width, 22),\n        height: Math.max(tBox.height, 22) * multiline.length\n      }\n    }\n    const selectGNode = (d: Mdata) => {\n      const ele = document.querySelector(`g[data-id='${getDataId(d)}']`)\n      const oldSele = document.getElementsByClassName(style.selected)[0]\n      if (ele) {\n        if (oldSele) {\n          if (oldSele !== ele) {\n            oldSele.classList.remove(style.selected)\n            ele.classList.add(style.selected)\n          } else {\n            editFlag = true\n          }\n        } else {\n          ele.classList.add(style.selected)\n        }\n      } else {\n        throw new Error(`g[data-id='${getDataId(d)}'] is null`)\n      }\n    }\n    const moveNode = (node: SVGGElement, d: Mdata, p: [number, number], dura = 0) => {\n      const tran = makeTransition(dura, d3.easePolyOut)\n      d.px = p[0]\n      d.py = p[1]\n      d3.select<SVGGElement, Mdata>(node).transition(tran).attr('transform', getGTransform)\n      d3.select<SVGPathElement, Mdata>(`g[data-id='${getDataId(d)}'] > path`).transition(tran).attr('d', getPath)\n    }\n    const makeTransition = (dura: number, easingFn: (normalizedTime: number) => number) => {\n      return d3.transition<Mdata>().duration(dura).ease(easingFn) as d3.Transition<any, Mdata, null, undefined>\n    }\n    // 监听事件\n    function onZoomMove (e: d3.D3ZoomEvent<SVGSVGElement, null>) {\n      if (!g.value) { return }\n      g.value.attr('transform', e.transform.toString())\n    }\n    function onDragMove (this: SVGGElement, e: d3.D3DragEvent<SVGGElement, Mdata, Mdata>, d: Mdata) {\n      if (!g.value) { return }\n      moveNode(this, d, [e.x - d.x, e.y - d.y])\n      // 鼠标相对gEle左上角的位置\n      const mousePos = d3.pointer(e, gEle.value)\n      mousePos[1] += mmdata.data.y\n\n      const temp = g.value.selectAll<SVGGElement, Mdata>('g.node').filter((other) => {\n        if (other !== d && other !== d.parent && !other.id.startsWith(d.id)) {\n          const rect = {\n            x0: other.x - rectPadding.value,\n            x1: other.x + other.width + rectPadding.value,\n            y0: other.y - rectPadding.value,\n            y1: other.y + other.height + rectPadding.value\n          }\n          return mousePos[0] > rect.x0 && mousePos[1] > rect.y0 && mousePos[0] < rect.x1 && mousePos[1] < rect.y1\n        }\n        return false\n      })\n      const old = Array.from(document.getElementsByClassName(style.outline))\n      const n = temp.node()\n      old.forEach((o) => { if (o !== n) { o.classList.remove(style.outline) } })\n      n?.classList.add(style.outline)\n    }\n    function onDragEnd (this: SVGGElement, e: d3.D3DragEvent<SVGGElement, Mdata, Mdata>, d: Mdata) {\n      // 判断是否找到了新的父节点\n      const np = document.getElementsByClassName(style.outline)[0]\n      if (np) {\n        np.classList.remove(style.outline)\n        const pid = np.getAttribute('data-id')\n        if (pid) {\n          reparent(pid, d.id)\n        } else {\n          throw new Error('outline data-id null')\n        }\n        return\n      }\n      // 判断是否需要调换节点顺序\n      const p = this.parentNode as SVGGElement\n      let downD = d\n      let upD = d\n      const brothers = d3.select<SVGGElement, Mdata>(p).selectAll<SVGGElement, Mdata>(`g.${getGClass(d).join('.')}`).filter((a) => a !== d)\n      brothers.each((b) => {\n        if (b.y > d.y && b.y < (d.y + d.py) && b.y > upD.y) { upD = b } // 找新哥哥节点\n        if (b.y < d.y && b.y > (d.y + d.py) && b.y < downD.y) { downD = b } // 找新弟弟节点\n      })\n      if (downD !== d) {\n        d.px = 0\n        d.py = 0\n        move(d.id, downD.id)\n        return\n      } else if (upD !== d) {\n        d.px = 0\n        d.py = 0\n        move(d.id, upD.id, 1)\n        return\n      }\n      // 复原\n      moveNode(this, d, [0, 0], 500)\n    }\n    function onEdit (this: SVGGElement, e: MouseEvent, d: Mdata) {\n      if (editFlag && foreign.value && foreignDivEle.value) {\n        this.classList.add(style.edited)\n        editFlag = false\n        foreign.value.attr('x', d.x - 2).attr('y', d.y - mmdata.data.y - 2)\n          .attr('data-id', d.id).attr('data-name', d.name).style('display', '')\n        const div = foreignDivEle.value\n        div.textContent = d.name\n        div.focus()\n        getSelection()?.selectAllChildren(div)\n      }\n    }\n    const onEditBlur = () => {\n      document.getElementsByClassName(style.edited)[0]?.classList.remove(style.edited, style.selected)\n\n      if (foreignEle.value && foreignDivEle.value) {\n        foreignEle.value.style.display = 'none'\n        const id = foreignEle.value.getAttribute('data-id')\n        const oldname = foreignEle.value.getAttribute('data-name')\n        const name = foreignDivEle.value.textContent\n        if (id && name && name !== oldname) {\n          rename(id, name)\n        }\n      }\n    }\n    const onSelect = (e: MouseEvent, d: Mdata) => {\n      e.stopPropagation()\n      selectGNode(d)\n    }\n    // 插件\n    const switchZoom = (zoomable: boolean) => {\n      if (!svg.value) { return }\n      if (zoomable) {\n        zoom(svg.value)\n        svg.value.on('dblclick.zoom', null)\n      } else {\n        svg.value.on('.zoom', null)\n      }\n    }\n    const switchEdit = (editable: boolean) => {\n      if (!foreignDivEle.value || !g.value) { return }\n      const gNode = g.value.selectAll<SVGGElement, Mdata>('g.node')\n      if (editable) {\n        gNode.on('click', onEdit)\n      } else {\n        gNode.on('click', null)\n      }\n    }\n    const switchDrag = (draggable: boolean) => {\n      if (!g.value) { return }\n      const temp = g.value.selectAll<SVGGElement, Mdata>(`g.node:not(.${style.root})`)\n      if (draggable) {\n        drag(temp)\n      } else {\n        temp.on('.drag', null)\n      }\n    }\n    const switchSelect = (selectable: boolean) => {\n      if (!g.value) { return }\n      const temp = g.value.selectAll<SVGGElement, Mdata>('g.node')\n      if (selectable) {\n        temp.on('mousedown', onSelect)\n      } else {\n        temp.on('mousedown', null)\n      }\n    }\n    // 一次操作\n    const rename = (id: string, name: string) => {\n      mmdata.rename(id, name)\n      draw()\n    }\n    const reparent = (pid: string, id: string) => {\n      mmdata.reparent(pid, id)\n      draw()\n    }\n    const move = (id: string, referenceId: string, after = 0) => {\n      mmdata.move(id, referenceId, after)\n      draw()\n    }\n    // 辅助按钮的点击事件\n    const centerView = () => {\n      if (!svg.value) { return }\n      const data = mmdata.data\n      zoom.translateTo(svg.value, 0 + data.width / 2, 0 + data.height / 2)\n    }\n    const fitView = () => { // 缩放至合适大小并移动至全部可见\n      // bug: 缩放后的大小与容器不一致\n      if (!svg.value || !gEle.value || !svgEle.value) { return }\n      const gBB = gEle.value.getBBox()\n      const svgBCR = svgEle.value.getBoundingClientRect()\n      const multiple = Math.min(svgBCR.width / gBB.width, svgBCR.height / gBB.height)\n      const svgCenter = { x: svgBCR.width / 2, y: svgBCR.height / 2 }\n      // after scale\n      const gCenter = { x: gBB.width * multiple / 2, y: gBB.height * multiple / 2 }\n      const center = d3.zoomIdentity.translate(\n        -gBB.x * multiple + svgCenter.x - gCenter.x,\n        -gBB.y * multiple + svgCenter.y - gCenter.y\n      ).scale(multiple)\n      zoom.transform(svg.value, center)\n    }\n    const download = () => {\n      const svgdiv = document.querySelector<HTMLDivElement>(`div.${style.svg}`)\n      if (svgdiv) {\n        html2canvas(svgdiv).then((canvas) => {\n          const dataUrl = canvas.toDataURL()\n          const window = open()\n          if (window) {\n            window.document.write(`<img src='${dataUrl}'>`)\n            window.document.title = mmdata.data.name\n            window.document.close()\n          }\n        })\n      }\n    }\n\n    return {\n      svgEle,\n      gEle,\n      style,\n      asstSvgEle,\n      foreignEle,\n      foreignDivEle,\n      centerView,\n      fitView,\n      download\n    }\n  }\n})\n","import { render } from \"./Mindmap.vue?vue&type=template&id=5414e73e&bindings={}\"\nimport script from \"./Mindmap.vue?vue&type=script&lang=ts\"\nexport * from \"./Mindmap.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","import Mindmap from './Mindmap.vue'\nexport default Mindmap\n","\nimport learn from '../public/learn.json'\nimport { defineComponent, reactive } from 'vue'\nimport Mindmap from './components/Mindmap'\ntype checkbox = { [key: string]: { value: boolean, disabled?: boolean } }\nexport default defineComponent({\n  name: 'App',\n  components: {\n    Mindmap\n  },\n  setup () {\n    const checkboxList = reactive<checkbox>({\n      'center-btn': { value: true },\n      'fit-btn': { value: true },\n      'undo-btn': { value: false, disabled: true },\n      'download-btn': { value: true },\n      keyboard: { value: false, disabled: true },\n      zoom: { value: true },\n      drag: { value: true },\n      edit: { value: true },\n      showNodeAdd: { value: false },\n      contextMenu: { value: false },\n      'sharp-corner': { value: false, disabled: true },\n      vertical: { value: false, disabled: true }\n    })\n    const rangeList = reactive({\n      branch: { value: 4, min: 0, max: 10 },\n      'x-gap': { value: 50, min: 0, max: 100 },\n      'y-gap': { value: 18, min: 0, max: 100 }\n    })\n    return {\n      learn,\n      checkboxList,\n      rangeList\n    }\n  }\n})\n","import { render } from \"./App.vue?vue&type=template&id=21fbefa9&bindings={}\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\n\nimport \"./App.vue?vue&type=style&index=0&lang=scss\"\nscript.render = render\n\nexport default script","import { createApp } from 'vue'\nimport App from './App.vue'\n\ncreateApp(App).mount('#app')\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Mindmap-module_container_26Zd2\",\"svg\":\"Mindmap-module_svg_2XgFd\",\"selected\":\"Mindmap-module_selected_PeP5y\",\"text\":\"Mindmap-module_text_3iUs6\",\"root\":\"Mindmap-module_root_nkPNF\",\"edited\":\"Mindmap-module_edited_23uKl\",\"outline\":\"Mindmap-module_outline_2Q5lo\",\"button-list\":\"Mindmap-module_button-list_eb1cI\",\"right-bottom\":\"Mindmap-module_right-bottom_VZ_4V\",\"top-right\":\"Mindmap-module_top-right_21t-w\",\"disabled\":\"Mindmap-module_disabled_1GAb3\",\"gps\":\"Mindmap-module_gps_q0wQJ\",\"fit\":\"Mindmap-module_fit_1uK7a\",\"download\":\"Mindmap-module_download_2edNx\",\"undo\":\"Mindmap-module_undo_257t-\",\"redo\":\"Mindmap-module_redo_2SvVM\",\"close\":\"Mindmap-module_close_2Wsf_\"};"],"sourceRoot":""}